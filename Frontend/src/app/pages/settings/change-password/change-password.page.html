<ion-content>
  <app-header [title]="title" />
  <div class="main-container">
    <div class="change-password-container">
      <form [formGroup]="form" (ngSubmit)="changePassword()">
        <ion-item>
          <ion-label position="floating">Contraseña Actual</ion-label>
          <ion-input
            type="password"
            formControlName="currentPassword"
          ></ion-input>
        </ion-item>
        <div
          class="error-message"
          *ngIf="form.get('currentPassword')?.invalid && form.get('currentPassword')?.touched"
        >
          La contraseña actual es requerida
        </div>

        <ion-item>
          <ion-label position="floating">Nueva Contraseña</ion-label>
          <ion-input type="password" formControlName="newPassword"></ion-input>
        </ion-item>
        <div
          class="error-message"
          *ngIf="form.get('newPassword')?.invalid && form.get('newPassword')?.touched"
        >
          <span *ngIf="form.get('newPassword')?.errors?.['required']"
            >La nueva contraseña es requerida</span
          >
          <span *ngIf="form.get('newPassword')?.errors?.['minlength']"
            >La contraseña debe tener al menos 6 caracteres</span
          >
        </div>

        <ion-item>
          <ion-label position="floating">Confirmar Contraseña</ion-label>
          <ion-input
            type="password"
            formControlName="confirmPassword"
          ></ion-input>
        </ion-item>
        <div
          class="error-message"
          *ngIf="form.hasError('passwordMismatch') && form.get('confirmPassword')?.touched"
        >
          Las contraseñas no coinciden
        </div>

        <ion-button
          expand="block"
          type="submit"
          [disabled]="form.invalid || isLoading"
        >
          <ion-spinner name="crescent" *ngIf="isLoading"></ion-spinner>
          <span *ngIf="!isLoading">Cambiar Contraseña</span>
        </ion-button>
      </form>
    </div>
  </div>
</ion-content>
